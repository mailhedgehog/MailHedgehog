import{o as n,c as a,a as e,u as ne,b as ae,x as le,d as re,r as k,f as O,e as ie,g as de,l as f,m as p,h as t,t as i,k as v,s as F,F as b,q as j,y as ce,n as S,j as D,p as g,z as B,A as C,N as ue,B as I,_ as me,U as pe,v as A,C as he,D as ve}from"./index.e90c5430.js";import{r as xe,a as fe}from"./TrashIcon.96e414d8.js";function _e(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function we(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function ye(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function ke(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function ge(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function be(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})])}function Ce(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})])}function Me(_,s){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})])}const He={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},$e={class:"flex justify-between py-3 lg:mx-auto lg:max-w-6xl"},je={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Le=["onClick"],Se={class:"hidden md:inline"},Ae={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Be={class:"inline-flex sm:shadow-sm"},Re=["onClick"],Te={class:"hidden md:inline"},Ee=["onClick"],Ue={class:"hidden md:inline"},Ve={class:"hidden md:inline"},qe={class:"px-4 sm:px-6 lg:px-8"},ze={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6 lg:mx-auto lg:max-w-6xl"},Ne={class:"px-4 py-5 sm:px-6"},Oe={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},Fe={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},De={class:"border-t border-context-200 px-4 py-5 sm:p-0"},Ie={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},Je={class:"text-sm font-medium text-context-500 dark:text-context-400"},Ke={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},We={key:0},Ge={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},Pe={class:"sm:hidden"},Qe=["value","selected"],Xe={class:"hidden sm:block lg:mx-auto lg:max-w-6xl"},Ye={class:"border-b border-context-200 dark:border-context-400"},Ze={class:"-mb-px flex space-x-8","aria-label":"Tabs"},et=["aria-current","onClick"],tt={key:0,class:"lg:mx-auto lg:max-w-6xl"},st={key:0,class:"py-6"},ot=["height","srcdoc"],nt={key:1,class:"flex justify-center items-center"},at={class:"ml-4 text-context-900 dark:text-context-100"},lt={key:1,class:"py-6"},rt={key:0,class:"text-context-900 dark:text-context-100"},it={class:"overflow-auto"},dt={key:1,class:"flex justify-center items-center"},ct={class:"ml-4 text-context-900 dark:text-context-100"},ut={key:2,class:"py-6"},mt={class:"text-context-900 dark:text-context-100"},pt={class:"overflow-auto"},ht={key:3,class:"py-6"},vt={key:0},xt={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},ft={class:"flex w-0 flex-1 items-center"},_t={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},wt={key:0,class:"ml-2"},yt={class:"ml-4 flex-shrink-0"},kt=["onClick"],gt={class:"hidden md:inline"},bt={key:1,class:"flex justify-center items-center"},Ct={class:"ml-4 text-context-900 dark:text-context-100"},Mt=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Ht={class:"fixed inset-0 z-10 overflow-y-auto"},$t={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},jt={class:"text-center sm:mt-5"},Lt={class:"mt-6 text-left text-context-900 dark:text-context-100"},St={class:"space-y-6"},At={for:"host",class:"form-label"},Bt={class:"mt-1 flex"},Rt={for:"smtp-username",class:"form-label"},Tt={class:"mt-1"},Et=["placeholder"],Ut=["placeholder"],Vt={class:"mt-6 sm:mt-8 flex items-center justify-between"},qt={class:"flex space-x-2 mx-2"},zt=["onClick"],Nt=["onClick"],It={__name:"Email",setup(_){const{t:s}=ne(),R=ae(),J=le(),K=re(),x=k(!1),d=k(null),W=o=>{x.value=!0,window.MailHedgehog.request().get(`emails/${o}`).then(r=>{var u,m;(u=r.data)!=null&&u.data?d.value=(m=r.data)==null?void 0:m.data:d.value=null}).catch(()=>{R.push({path:"/404"})}).finally(()=>{x.value=!1})};O(()=>{W(J.params.id)});const T=()=>{R.push({name:"emails",params:{}})},G=()=>{K.dispatch("confirmDialog/confirm").then(()=>{x.value=!0,window.MailHedgehog.request().delete(`emails/${d.value.id}`).then(()=>{window.MailHedgehog.success(s("email.deleted")),ve(()=>T())}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{x.value=!1})})},E=(o,r,u)=>{const m=new Blob([o],{type:r}),w=document.createElement("a");w.href=URL.createObjectURL(m),w.download=u,w.click(),URL.revokeObjectURL(w.href),w.remove()};function P(o,r){const u=`emails/${d.value.id}/attachment/${o}`;window.MailHedgehog.request().get(u).then(()=>{const m=document.createElement("a");m.download=r,m.href=`${window.MailHedgehog.request().defaults.baseURL}/${u}`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{x.value=!1})}const Q=()=>{E(d.value.source,"text/plain",`${d.value.id}.eml`)},X=o=>{o.data&&o.data.length>0?E(o.data,o.contentType,o.filename):P(o.index,o.filename)},M=k(!1),Y=["Subject","From","To","Cc"],Z=ie(()=>{const o={};if(d.value&&d.value.headers)for(let r=0;r<Object.entries(d.value.headers).length;r+=1){const[u,m]=Object.entries(d.value.headers)[r];Array.isArray(m)&&m.length>0&&(M.value||Y.includes(u))&&(o[u]=m)}return o}),h=k("html"),U=[{id:"html"},{id:"plain"},{id:"source"},{id:"attachments"}],V=k("0rem"),ee=o=>{const u=o.currentTarget.contentWindow.document.documentElement.scrollHeight+2;V.value=`${u}px`},c=k({host:"",port:25,username:"",password:""}),q=()=>{let o=localStorage.getItem("smtpReleaseCredentials");if(o)try{o=JSON.parse(atob(o)),typeof o=="object"&&!Array.isArray(o)&&o!==null&&(o.host&&(c.value.host=o.host),o.port&&(c.value.port=o.port),o.username&&(c.value.username=o.username),o.password&&(c.value.password=o.password))}catch(r){window.MailHedgehog.error(r.message)}},te=()=>{localStorage.removeItem("smtpReleaseCredentials"),window.MailHedgehog.success(s("release.deleted"))},se=()=>{const o={};c.value.host&&(o.host=c.value.host),c.value.port&&(o.port=c.value.port),c.value.username&&(o.username=c.value.username),c.value.password&&(o.password=c.value.password),localStorage.setItem("smtpReleaseCredentials",btoa(JSON.stringify(o))),q(),window.MailHedgehog.success(s("release.saved"))};O(()=>q());const H=k(!1),oe=()=>{x.value=!0,window.MailHedgehog.request().post(`emails/${d.value.id}/release`,c.value).then(()=>{H.value=!1,window.MailHedgehog.success(s("email.released"))}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{x.value=!1})};return(o,r)=>{var m,w,z;const u=de("tooltip");return n(),a(b,null,[e("div",{class:S(["flex flex-col justify-center",{"pointer-events-none opacity-75":x.value}])},[e("div",He,[e("div",$e,[e("div",null,[e("div",je,[e("button",{type:"button",class:"btn btn--default",onClick:f(T,["prevent"])},[p(t(ke),{class:"md:mr-2 h-5 w-5"}),e("span",Se,i(t(s)("email.back")),1)],8,Le)])]),e("div",null,[e("div",Ae,[e("span",Be,[v((n(),a("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:f(G,["prevent"])},[p(t(xe),{class:"md:mr-2 h-5 w-5"}),e("span",Te,i(t(s)("email.delete")),1)],8,Re)),[[u,t(s)("email.deleteHint")]]),v((n(),a("button",{type:"button",class:"btn btn--default rounded-none",onClick:f(Q,["prevent"])},[p(t(ge),{class:"md:mr-2 h-5 w-5"}),e("span",Ue,i(t(s)("email.download")),1)],8,Ee)),[[u,t(s)("email.downloadHint")]]),v((n(),a("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:r[0]||(r[0]=f(l=>H.value=!0,["prevent"]))},[p(t(Ce),{class:"md:mr-2 h-5 w-5"}),e("span",Ve,i(t(s)("email.release")),1)])),[[u,t(s)("email.releaseHint")]])])])])])]),e("div",qe,[e("div",ze,[e("div",Ne,[e("h3",Oe,[e("div",null,i(t(s)("email.headersTitle")),1),e("div",null,[v((n(),a("a",{class:"cursor-pointer",onClick:r[1]||(r[1]=f(l=>M.value=!M.value,["prevent"]))},[M.value?(n(),F(t(be),{key:0,class:"text-primary-400 h-5 w-5"})):(n(),F(t(fe),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[u,M.value?t(s)("email.hintHideHeaders"):t(s)("email.hintShowHeaders")]])])]),e("p",Fe,i(t(s)("email.headersSubtitle")),1)]),e("div",De,[e("dl",Ie,[(n(!0),a(b,null,j(t(Z),(l,y)=>(n(),a("div",{key:y,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[e("dt",Je,i(y),1),e("dd",Ke,[l.length===1?(n(),a("div",We,i(l[0]),1)):(n(),a("ul",Ge,[(n(!0),a(b,null,j(l,($,L)=>(n(),a("li",{key:L,class:"py-3 pl-3 pr-4 text-sm"},i($),1))),128))]))])]))),128))])])]),e("div",null,[e("div",Pe,[v(e("select",{id:"tabs","onUpdate:modelValue":r[2]||(r[2]=l=>h.value=l),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(n(),a(b,null,j(U,l=>e("option",{key:l.id,value:l.id,selected:h.value},i(t(s)(`email.tab.${l.id}`)),9,Qe)),64))],512),[[ce,h.value]])]),e("div",Xe,[e("div",Ye,[e("nav",Ze,[(n(),a(b,null,j(U,l=>{var y,$,L,N;return e("a",{key:l.id,href:"#",class:S(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[h.value===l.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":h.value===l.id?"page":void 0,onClick:f(Ot=>h.value=l.id,["prevent"])},[D(i(t(s)(`email.tab.${l.id}`))+" ",1),l.id==="attachments"&&(($=(y=d.value)==null?void 0:y.attachments)==null?void 0:$.length)!==void 0?(n(),a("span",{key:0,class:S(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[h.value===l.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},i((N=(L=d.value)==null?void 0:L.attachments)==null?void 0:N.length),3)):g("",!0)],10,et)}),64))])])])]),d.value?(n(),a("div",tt,[h.value==="html"?(n(),a("div",st,[d.value.html?(n(),a("iframe",{key:0,id:"preview-html",height:V.value,srcdoc:d.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:ee},null,40,ot)):(n(),a("div",nt,[p(t(B),{class:"text-primary-500 h-8 w-8"}),e("div",at,i(t(s)("email.htmlEmpty")),1)]))])):g("",!0),h.value==="plain"?(n(),a("div",lt,[d.value.plain?(n(),a("div",rt,[e("pre",it,i(d.value.plain),1)])):(n(),a("div",dt,[p(t(B),{class:"text-primary-500 h-8 w-8"}),e("div",ct,i(t(s)("email.plainEmpty")),1)]))])):g("",!0),h.value==="source"?(n(),a("div",ut,[e("div",mt,[e("pre",pt,i(d.value.source),1)])])):g("",!0),h.value==="attachments"?(n(),a("div",ht,[((w=(m=d.value)==null?void 0:m.attachments)==null?void 0:w.length)>0?(n(),a("div",vt,[e("ul",xt,[(n(!0),a(b,null,j((z=d.value)==null?void 0:z.attachments,(l,y)=>(n(),a("li",{key:y,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[e("div",ft,[p(t(Me),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),e("span",_t,[e("span",null,i(l.filename),1),l.contentType?(n(),a("span",wt," ("+i(l.contentType)+") ",1)):g("",!0)])]),e("div",yt,[e("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:f($=>X(l),["prevent"])},[p(t(ye),{class:"md:hidden flex-shrink-0 h-5 w-5"}),e("span",gt,i(t(s)("email.download")),1)],8,kt)])]))),128))])])):(n(),a("div",bt,[p(t(B),{class:"text-primary-500 h-8 w-8"}),e("div",Ct,i(t(s)("email.noAttachments")),1)]))])):g("",!0)])):g("",!0)])],2),p(t(he),{as:"template",show:H.value},{default:C(()=>[p(t(ue),{as:"div",class:S(["relative z-10",{"pointer-events-none":x.value}]),onClose:r[8]||(r[8]=l=>H.value=!1)},{default:C(()=>[p(t(I),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:C(()=>[Mt]),_:1}),e("div",Ht,[e("div",$t,[p(t(I),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:C(()=>[p(t(me),{class:"bg-context-50 dark:bg-context-900 relative transform overflow-hidden rounded-lg px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:C(()=>[e("div",null,[e("div",jt,[p(t(pe),{as:"h3",class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100"},{default:C(()=>[D(i(t(s)("email.releaseHint")),1)]),_:1}),e("div",Lt,[e("div",St,[e("div",null,[e("label",At,i(t(s)("release.host")),1),e("div",Bt,[v(e("input",{id:"host","onUpdate:modelValue":r[3]||(r[3]=l=>c.value.host=l),name:"host",type:"text",autocomplete:"host",required:"",class:"form-input rounded-r-none",placeholder:"smtp.provider.com"},null,512),[[A,c.value.host]]),v(e("input",{id:"port","onUpdate:modelValue":r[4]||(r[4]=l=>c.value.port=l),name:"port",type:"number",min:"1",max:"9999",step:"1",autocomplete:"port",required:"",class:"form-input rounded-l-none w-20",placeholder:"25"},null,512),[[A,c.value.port],[u,t(s)("release.port")]])])]),e("div",null,[e("label",Rt,i(t(s)("release.auth")),1),e("div",Tt,[v(e("input",{id:"smtp-username","onUpdate:modelValue":r[5]||(r[5]=l=>c.value.username=l),name:"smtp-username",type:"text",autocomplete:"smtp-username",class:"form-input rounded-b-none",placeholder:t(s)("release.username")},null,8,Et),[[A,c.value.username]]),v(e("input",{id:"smtp-password","onUpdate:modelValue":r[6]||(r[6]=l=>c.value.password=l),name:"smtp-password",type:"password",autocomplete:"smtp-password",class:"form-input rounded-t-none",placeholder:t(s)("release.password")},null,8,Ut),[[A,c.value.password]])])])])])])]),e("div",Vt,[e("button",{type:"button",class:"btn btn--default",onClick:r[7]||(r[7]=l=>H.value=!1)},i(t(s)("email.cancel")),1),e("div",qt,[v((n(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:f(se,["prevent"])},[p(t(_e),{class:"h-6 w-6"})],8,zt)),[[u,t(s)("release.saveToStorage")]]),v((n(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:f(te,["prevent"])},[p(t(we),{class:"h-6 w-6"})],8,Nt)),[[u,t(s)("release.deleteSavedToStorage")]])]),e("button",{type:"button",class:"btn btn--primary",onClick:oe},i(t(s)("email.release")),1)])]),_:1})]),_:1})])])]),_:1},8,["class"])]),_:1},8,["show"])],64)}}};export{It as default};
