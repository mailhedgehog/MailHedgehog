import{o as t,c as s,a as e,u as K,d as W,y as G,r as b,g as J,f as P,h as Q,m as k,p as x,j as n,t as l,l as M,v as z,F as g,s as j,z as X,n as H,k as Y,q as p,A as Z}from"./index.a0bb47d5.js";import{r as ee,a as te}from"./TrashIcon.7d55135a.js";function se(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function oe(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function ne(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function L(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])}function re(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})])}function ae(_,o){return t(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})])}const le={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},ie={class:"flex justify-between py-3"},de={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},ce=["onClick"],ue={class:"hidden md:inline"},me={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},he={class:"inline-flex sm:shadow-sm"},xe=["onClick"],ve={class:"hidden md:inline"},pe=["onClick"],_e={class:"hidden md:inline"},ke={class:"px-4 sm:px-6 lg:px-8"},we={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6"},fe={class:"px-4 py-5 sm:px-6"},ye={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},be={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},ge={class:"border-t border-context-200 px-4 py-5 sm:p-0"},je={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},Ce={class:"text-sm font-medium text-context-500 dark:text-context-400"},Me={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},He={key:0},Le={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},$e={class:"sm:hidden"},Be=["value","selected"],Ae={class:"hidden sm:block"},Te={class:"border-b border-context-200 dark:border-context-400"},Ee={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Re=["aria-current","onClick"],Ve={key:0},ze={key:0,class:"py-6"},Oe=["height","srcdoc"],Se={key:1,class:"flex justify-center items-center"},Ue={class:"ml-4 text-context-900 dark:text-context-100"},qe={key:1,class:"py-6"},De={key:0,class:"text-context-900 dark:text-context-100"},Fe={class:"overflow-auto"},Ne={key:1,class:"flex justify-center items-center"},Ie={class:"ml-4 text-context-900 dark:text-context-100"},Ke={key:2,class:"py-6"},We={class:"text-context-900 dark:text-context-100"},Ge={class:"overflow-auto"},Je={key:3,class:"py-6"},Pe={key:0},Qe={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},Xe={class:"flex w-0 flex-1 items-center"},Ye={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},Ze={key:0,class:"ml-2"},et={class:"ml-4 flex-shrink-0"},tt=["onClick"],st={class:"hidden md:inline"},ot={key:1,class:"flex justify-center items-center"},nt={class:"ml-4 text-context-900 dark:text-context-100"},it={__name:"Email",setup(_){const{t:o}=K(),$=W(),O=G(),w=b(!1),a=b(null),S=i=>{w.value=!0,window.MailHedgehog.request().get(`emails/${i}`).then(d=>{var c,u;(c=d.data)!=null&&c.data?a.value=(u=d.data)==null?void 0:u.data:a.value=null}).catch(()=>{$.push({path:"/404"})}).finally(()=>{w.value=!1})};J(()=>{S(O.params.id)});const B=()=>{$.push({name:"emails",params:{}})},U=()=>{console.warn("TODO: add confirmation"),w.value=!0,window.MailHedgehog.request().delete(`emails/${a.value.id}`).then(()=>{window.MailHedgehog.success(o("email.deleted")),Z(()=>B())}).catch(()=>{window.MailHedgehog.error(o("response.error"))}).finally(()=>{w.value=!1})},A=(i,d,c)=>{const u=new Blob([i],{type:d}),h=document.createElement("a");h.href=URL.createObjectURL(u),h.download=c,h.click(),URL.revokeObjectURL(h.href),h.remove()},q=()=>{A(a.value.source,"text/plain",`${a.value.id}.eml`)},D=i=>{A(i.data,i.contentType,i.filename)},f=b(!1),F=["Subject","From","To","Cc"],N=P(()=>{const i={};if(a.value&&a.value.headers)for(let d=0;d<Object.entries(a.value.headers).length;d+=1){const[c,u]=Object.entries(a.value.headers)[d];Array.isArray(u)&&u.length>0&&(f.value||F.includes(c))&&(i[c]=u)}return i}),m=b("html"),T=[{id:"html",name:o("email.tab.html")},{id:"plain",name:o("email.tab.plain")},{id:"source",name:o("email.tab.source")},{id:"attachments",name:o("email.tab.attachments")}],E=b("0rem"),I=i=>{const c=i.currentTarget.contentWindow.document.documentElement.scrollHeight+2;E.value=`${c}px`};return(i,d)=>{var u,h,R;const c=Q("tooltip");return t(),s("div",{class:H(["flex flex-col justify-center",{"pointer-events-none opacity-75":w.value}])},[e("div",le,[e("div",ie,[e("div",null,[e("div",de,[e("button",{type:"button",class:"btn btn--default",onClick:k(B,["prevent"])},[x(n(oe),{class:"md:mr-2 h-5 w-5"}),e("span",ue,l(n(o)("email.back")),1)],8,ce)])]),e("div",null,[e("div",me,[e("span",he,[M((t(),s("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:k(U,["prevent"])},[x(n(ee),{class:"md:mr-2 h-5 w-5"}),e("span",ve,l(n(o)("email.delete")),1)],8,xe)),[[c,n(o)("email.deleteHint")]]),M((t(),s("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:k(q,["prevent"])},[x(n(ne),{class:"md:mr-2 h-5 w-5"}),e("span",_e,l(n(o)("email.download")),1)],8,pe)),[[c,n(o)("email.downloadHint")]])])])])])]),e("div",ke,[e("div",we,[e("div",fe,[e("h3",ye,[e("div",null,l(n(o)("email.headersTitle")),1),e("div",null,[M((t(),s("a",{class:"cursor-pointer",onClick:d[0]||(d[0]=k(r=>f.value=!f.value,["prevent"]))},[f.value?(t(),z(n(re),{key:0,class:"text-primary-400 h-5 w-5"})):(t(),z(n(te),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[c,f.value?n(o)("email.hintHideHeaders"):n(o)("email.hintShowHeaders")]])])]),e("p",be,l(n(o)("email.headersSubtitle")),1)]),e("div",ge,[e("dl",je,[(t(!0),s(g,null,j(n(N),(r,v)=>(t(),s("div",{key:v,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[e("dt",Ce,l(v),1),e("dd",Me,[r.length===1?(t(),s("div",He,l(r[0]),1)):(t(),s("ul",Le,[(t(!0),s(g,null,j(r,(y,C)=>(t(),s("li",{key:C,class:"py-3 pl-3 pr-4 text-sm"},l(y),1))),128))]))])]))),128))])])]),e("div",null,[e("div",$e,[M(e("select",{id:"tabs","onUpdate:modelValue":d[1]||(d[1]=r=>m.value=r),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(t(),s(g,null,j(T,r=>e("option",{key:r.id,value:r.id,selected:m.value},l(r.name),9,Be)),64))],512),[[X,m.value]])]),e("div",Ae,[e("div",Te,[e("nav",Ee,[(t(),s(g,null,j(T,r=>{var v,y,C,V;return e("a",{key:r.id,href:"#",class:H(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[m.value===r.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":m.value===r.id?"page":void 0,onClick:k(rt=>m.value=r.id,["prevent"])},[Y(l(r.name)+" ",1),r.id==="attachments"&&((y=(v=a.value)==null?void 0:v.attachments)==null?void 0:y.length)!==void 0?(t(),s("span",{key:0,class:H(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[m.value===r.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},l((V=(C=a.value)==null?void 0:C.attachments)==null?void 0:V.length),3)):p("",!0)],10,Re)}),64))])])])]),a.value?(t(),s("div",Ve,[m.value==="html"?(t(),s("div",ze,[a.value.html?(t(),s("iframe",{key:0,id:"preview-html",height:E.value,srcdoc:a.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:I},null,40,Oe)):(t(),s("div",Se,[x(n(L),{class:"text-primary-500 h-8 w-8"}),e("div",Ue,l(n(o)("email.htmlEmpty")),1)]))])):p("",!0),m.value==="plain"?(t(),s("div",qe,[a.value.plain?(t(),s("div",De,[e("pre",Fe,l(a.value.plain),1)])):(t(),s("div",Ne,[x(n(L),{class:"text-primary-500 h-8 w-8"}),e("div",Ie,l(n(o)("email.plainEmpty")),1)]))])):p("",!0),m.value==="source"?(t(),s("div",Ke,[e("div",We,[e("pre",Ge,l(a.value.source),1)])])):p("",!0),m.value==="attachments"?(t(),s("div",Je,[((h=(u=a.value)==null?void 0:u.attachments)==null?void 0:h.length)>0?(t(),s("div",Pe,[e("ul",Qe,[(t(!0),s(g,null,j((R=a.value)==null?void 0:R.attachments,(r,v)=>(t(),s("li",{key:v,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[e("div",Xe,[x(n(ae),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),e("span",Ye,[e("span",null,l(r.filename),1),r.contentType?(t(),s("span",Ze," ("+l(r.contentType)+") ",1)):p("",!0)])]),e("div",et,[e("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:k(y=>D(r),["prevent"])},[x(n(se),{class:"md:hidden flex-shrink-0 h-5 w-5"}),e("span",st,l(n(o)("email.download")),1)],8,tt)])]))),128))])])):(t(),s("div",ot,[x(n(L),{class:"text-primary-500 h-8 w-8"}),e("div",nt,l(n(o)("email.noAttachments")),1)]))])):p("",!0)])):p("",!0)])],2)}}};export{it as default};
