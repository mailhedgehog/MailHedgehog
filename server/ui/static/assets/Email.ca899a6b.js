import{o,c as n,a as t,i as Q,b as W,l as j,d as ae,J as ne,L as re,u as le,m as ie,p as de,s as f,v as m,k as e,t as i,q as v,g as G,F as b,f as M,M as ce,N as me,n as B,j as H,x as k,w as g,K as A,A as ue}from"./index.7c685518.js";import{u as pe,a as xe,b as ve,c as he,r as fe,d as _e,e as ye,f as we}from"./email-attachments.8adca39d.js";import{r as ke}from"./TrashIcon.82a765dc.js";import{r as be}from"./EyeIcon.ee974f1b.js";import{r as N}from"./ExclamationTriangleIcon.9a469e73.js";import{N as ge,o as P,_ as Ce,U as Se,f as $e}from"./transition.e74a1682.js";import"./use-outside-click.1cf8d48f.js";function Ee(d,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function Re(d,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function Me(d,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function je(d,a){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})])}function Le(){const d=Q("MailHedgehog"),{t:a}=W(),x=j(!1),C=j(!1),u=j({host:"",port:25,username:"",password:""}),L=()=>{const p=localStorage.getItem("smtpReleaseCredentials");if(p)try{const l=JSON.parse(atob(p));typeof l=="object"&&!Array.isArray(l)&&l!==null&&(l.host&&(u.value.host=l.host),l.port&&(u.value.port=l.port),l.username&&(u.value.username=l.username),l.password&&(u.value.password=l.password))}catch(l){d==null||d.error(l==null?void 0:l.message)}};return{isOpenReleaseModal:C,releaseForm:u,fromLocalStorage:L,clearFromLocalStorage:()=>{localStorage.removeItem("smtpReleaseCredentials"),d==null||d.success(a("release.deleted"))},saveToLocalStorage:()=>{const p={};u.value.host&&(p.host=u.value.host),u.value.port&&(p.port=u.value.port),u.value.username&&(p.username=u.value.username),u.value.password&&(p.password=u.value.password),localStorage.setItem("smtpReleaseCredentials",btoa(JSON.stringify(p))),L(),d==null||d.success(a("release.saved"))},releaseEmail:p=>{!p||(x.value=!0,d==null||d.request().post(`emails/${p==null?void 0:p.id}/release`,u.value).then(()=>{C.value=!1,d==null||d.success(a("email.released"))}).catch(()=>{d==null||d.error(a("response.error"))}).finally(()=>{x.value=!1}))},isRequestingReleaseEmail:x}}const Te={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},qe={class:"flex justify-between py-3 lg:mx-auto lg:max-w-6xl"},Be={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Ae=["onClick"],Ne={class:"hidden md:inline"},ze={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Fe={class:"inline-flex sm:shadow-sm"},Ue=["onClick"],Ve={class:"hidden md:inline"},Ie={class:"hidden md:inline"},De={class:"hidden md:inline"},Oe={class:"px-4 sm:px-6 lg:px-8"},Je={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6 lg:mx-auto lg:max-w-6xl"},Ke={class:"px-4 py-5 sm:px-6"},Ge={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},He={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},Pe={class:"border-t border-context-200 px-4 py-5 sm:p-0"},Qe={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},We={class:"text-sm font-medium text-context-500 dark:text-context-400"},Xe={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},Ye={key:0},Ze={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},et={class:"sm:hidden"},tt=["value","selected"],st={class:"hidden sm:block lg:mx-auto lg:max-w-6xl"},ot={class:"border-b border-context-200 dark:border-context-400"},at={class:"-mb-px flex space-x-8","aria-label":"Tabs"},nt=["aria-current","onClick"],rt={key:0,class:"lg:mx-auto lg:max-w-6xl"},lt={key:0,class:"py-6"},it=["height","srcdoc"],dt={key:1,class:"flex justify-center items-center"},ct={class:"ml-4 text-context-900 dark:text-context-100"},mt={key:1,class:"py-6"},ut={key:0,class:"text-context-900 dark:text-context-100"},pt={class:"overflow-auto"},xt={key:1,class:"flex justify-center items-center"},vt={class:"ml-4 text-context-900 dark:text-context-100"},ht={key:2,class:"py-6"},ft={class:"text-context-900 dark:text-context-100"},_t={class:"overflow-auto"},yt={key:3,class:"py-6"},wt={key:0},kt={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},bt={class:"flex w-0 flex-1 items-center"},gt={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},Ct={key:0,class:"ml-2"},St={class:"ml-4 flex-shrink-0"},$t=["onClick"],Et={class:"hidden md:inline"},Rt={key:1,class:"flex justify-center items-center"},Mt={class:"ml-4 text-context-900 dark:text-context-100"},jt=t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Lt={class:"fixed inset-0 z-10 overflow-y-auto"},Tt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},qt={class:"text-center sm:mt-5"},Bt={class:"mt-6 text-left text-context-900 dark:text-context-100"},At={class:"space-y-6"},Nt={for:"host",class:"form-label"},zt={class:"mt-1 flex"},Ft={for:"smtp-username",class:"form-label"},Ut={class:"mt-1"},Vt=["placeholder"],It=["placeholder"],Dt={class:"mt-6 sm:mt-8 flex items-center justify-between"},Ot={class:"flex space-x-2 mx-2"},Yt=ae({__name:"Email",setup(d){const{t:a}=W(),x=Q("MailHedgehog"),C=ne(),u=re(),L=le(),y=j(!1),c=j(null),{isAllHeaders:S,headers:p}=pe(c),{currentTab:l,tabs:z}=xe(),{iframeHeight:X,resizeIframe:F}=ve(),{downloadEmailAttachment:Y,downloadEmail:Z}=he(c),{isOpenReleaseModal:T,releaseForm:_,fromLocalStorage:ee,clearFromLocalStorage:U,saveToLocalStorage:V,releaseEmail:te,isRequestingReleaseEmail:I}=Le(),se=$=>{y.value=!0,x==null||x.request().get(`emails/${$}`).then(r=>{var h,E;(h=r.data)!=null&&h.data?c.value=(E=r.data)==null?void 0:E.data:c.value=null}).catch(()=>{C.push({path:"/404"})}).finally(()=>{y.value=!1})};ie(()=>{ee(),se(u.params.id)});const D=()=>{C.push({name:"emails",params:{}})},oe=()=>{!c.value||L.dispatch("confirmDialog/confirm").then(()=>{var $;y.value=!0,x==null||x.request().delete(`emails/${($=c.value)==null?void 0:$.id}`).then(()=>{x==null||x.success(a("email.deleted")),ue(()=>D())}).catch(r=>{x.onResponseError(r,"Response Error")}).finally(()=>{y.value=!1})})};return($,r)=>{var E,O,J;const h=de("tooltip");return o(),n(b,null,[t("div",{class:B(["flex flex-col justify-center",{"pointer-events-none opacity-75":y.value||e(I)}])},[t("div",Te,[t("div",qe,[t("div",null,[t("div",Be,[t("button",{type:"button",class:"btn btn--default",onClick:f(D,["prevent"])},[m(e(Me),{class:"md:mr-2 h-5 w-5"}),t("span",Ne,i(e(a)("email.back")),1)],8,Ae)])]),t("div",null,[t("div",ze,[t("span",Fe,[v((o(),n("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:f(oe,["prevent"])},[m(e(ke),{class:"md:mr-2 h-5 w-5"}),t("span",Ve,i(e(a)("email.delete")),1)],8,Ue)),[[h,e(a)("email.deleteHint")]]),v((o(),n("button",{type:"button",class:"btn btn--default rounded-none",onClick:r[0]||(r[0]=f(s=>e(Z)(),["prevent"]))},[m(e(fe),{class:"md:mr-2 h-5 w-5"}),t("span",Ie,i(e(a)("email.download")),1)])),[[h,e(a)("email.downloadHint")]]),v((o(),n("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:r[1]||(r[1]=f(s=>T.value=!0,["prevent"]))},[m(e(je),{class:"md:mr-2 h-5 w-5"}),t("span",De,i(e(a)("email.release")),1)])),[[h,e(a)("email.releaseHint")]])])])])])]),t("div",Oe,[t("div",Je,[t("div",Ke,[t("h3",Ge,[t("div",null,i(e(a)("email.headersTitle")),1),t("div",null,[v((o(),n("a",{class:"cursor-pointer",onClick:r[2]||(r[2]=f(s=>S.value=!e(S),["prevent"]))},[e(S)?(o(),G(e(_e),{key:0,class:"text-primary-400 h-5 w-5"})):(o(),G(e(be),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[h,e(S)?e(a)("email.hintHideHeaders"):e(a)("email.hintShowHeaders")]])])]),t("p",He,i(e(a)("email.headersSubtitle")),1)]),t("div",Pe,[t("dl",Qe,[(o(!0),n(b,null,M(e(p),(s,w)=>(o(),n("div",{key:w,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[t("dt",We,i(w),1),t("dd",Xe,[s.length===1?(o(),n("div",Ye,i(s[0]),1)):(o(),n("ul",Ze,[(o(!0),n(b,null,M(s,(R,q)=>(o(),n("li",{key:q,class:"py-3 pl-3 pr-4 text-sm"},i(R),1))),128))]))])]))),128))])])]),t("div",null,[t("div",et,[v(t("select",{id:"tabs","onUpdate:modelValue":r[3]||(r[3]=s=>me(l)?l.value=s:null),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(o(!0),n(b,null,M(e(z),s=>(o(),n("option",{key:s.id,value:s.id,selected:e(l)==s.id},i(e(a)(`email.tab.${s.id}`)),9,tt))),128))],512),[[ce,e(l)]])]),t("div",st,[t("div",ot,[t("nav",at,[(o(!0),n(b,null,M(e(z),s=>{var w,R,q,K;return o(),n("a",{key:s.id,href:"#",class:B(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[e(l)===s.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":e(l)===s.id?"page":void 0,onClick:f(Jt=>l.value=s.id,["prevent"])},[H(i(e(a)(`email.tab.${s.id}`))+" ",1),s.id==="attachments"&&((R=(w=c.value)==null?void 0:w.attachments)==null?void 0:R.length)!==void 0?(o(),n("span",{key:0,class:B(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[e(l)===s.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},i((K=(q=c.value)==null?void 0:q.attachments)==null?void 0:K.length),3)):k("",!0)],10,nt)}),128))])])])]),c.value?(o(),n("div",rt,[e(l)==="html"?(o(),n("div",lt,[c.value.html?(o(),n("iframe",{key:0,id:"preview-html",height:e(X),srcdoc:c.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:r[4]||(r[4]=(...s)=>e(F)&&e(F)(...s))},null,40,it)):(o(),n("div",dt,[m(e(N),{class:"text-primary-500 h-8 w-8"}),t("div",ct,i(e(a)("email.htmlEmpty")),1)]))])):k("",!0),e(l)==="plain"?(o(),n("div",mt,[c.value.plain?(o(),n("div",ut,[t("pre",pt,i(c.value.plain),1)])):(o(),n("div",xt,[m(e(N),{class:"text-primary-500 h-8 w-8"}),t("div",vt,i(e(a)("email.plainEmpty")),1)]))])):k("",!0),e(l)==="source"?(o(),n("div",ht,[t("div",ft,[t("pre",_t,i(c.value.source),1)])])):k("",!0),e(l)==="attachments"?(o(),n("div",yt,[((O=(E=c.value)==null?void 0:E.attachments)==null?void 0:O.length)>0?(o(),n("div",wt,[t("ul",kt,[(o(!0),n(b,null,M((J=c.value)==null?void 0:J.attachments,(s,w)=>(o(),n("li",{key:w,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[t("div",bt,[m(e(ye),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),t("span",gt,[t("span",null,i(s.filename),1),s.contentType?(o(),n("span",Ct," ("+i(s.contentType)+") ",1)):k("",!0)])]),t("div",St,[t("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:f(R=>e(Y)(s),["prevent"])},[m(e(we),{class:"md:hidden flex-shrink-0 h-5 w-5"}),t("span",Et,i(e(a)("email.download")),1)],8,$t)])]))),128))])])):(o(),n("div",Rt,[m(e(N),{class:"text-primary-500 h-8 w-8"}),t("div",Mt,i(e(a)("email.noAttachments")),1)]))])):k("",!0)])):k("",!0)])],2),m(e($e),{as:"template",show:e(T)},{default:g(()=>[m(e(ge),{as:"div",class:B(["relative z-10",{"pointer-events-none":y.value||e(I)}]),onClose:r[13]||(r[13]=s=>T.value=!1)},{default:g(()=>[m(e(P),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:g(()=>[jt]),_:1}),t("div",Lt,[t("div",Tt,[m(e(P),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:g(()=>[m(e(Ce),{class:"bg-context-50 dark:bg-context-900 relative transform overflow-hidden rounded-lg px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:g(()=>[t("div",null,[t("div",qt,[m(e(Se),{as:"h3",class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100"},{default:g(()=>[H(i(e(a)("email.releaseHint")),1)]),_:1}),t("div",Bt,[t("div",At,[t("div",null,[t("label",Nt,i(e(a)("release.host")),1),t("div",zt,[v(t("input",{id:"host","onUpdate:modelValue":r[5]||(r[5]=s=>e(_).host=s),name:"host",type:"text",autocomplete:"host",required:"",class:"form-input rounded-r-none",placeholder:"smtp.provider.com"},null,512),[[A,e(_).host]]),v(t("input",{id:"port","onUpdate:modelValue":r[6]||(r[6]=s=>e(_).port=s),name:"port",type:"number",min:"1",max:"9999",step:"1",autocomplete:"port",required:"",class:"form-input rounded-l-none w-20",placeholder:"25"},null,512),[[A,e(_).port],[h,e(a)("release.port")]])])]),t("div",null,[t("label",Ft,i(e(a)("release.auth")),1),t("div",Ut,[v(t("input",{id:"smtp-username","onUpdate:modelValue":r[7]||(r[7]=s=>e(_).username=s),name:"smtp-username",type:"text",autocomplete:"smtp-username",class:"form-input rounded-b-none",placeholder:e(a)("release.username")},null,8,Vt),[[A,e(_).username]]),v(t("input",{id:"smtp-password","onUpdate:modelValue":r[8]||(r[8]=s=>e(_).password=s),name:"smtp-password",type:"password",autocomplete:"smtp-password",class:"form-input rounded-t-none",placeholder:e(a)("release.password")},null,8,It),[[A,e(_).password]])])])])])])]),t("div",Dt,[t("button",{type:"button",class:"btn btn--default",onClick:r[9]||(r[9]=s=>T.value=!1)},i(e(a)("email.cancel")),1),t("div",Ot,[v((o(),n("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:r[10]||(r[10]=f((...s)=>e(V)&&e(V)(...s),["prevent"]))},[m(e(Ee),{class:"h-6 w-6"})])),[[h,e(a)("release.saveToStorage")]]),v((o(),n("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:r[11]||(r[11]=f((...s)=>e(U)&&e(U)(...s),["prevent"]))},[m(e(Re),{class:"h-6 w-6"})])),[[h,e(a)("release.deleteSavedToStorage")]])]),t("button",{type:"button",class:"btn btn--primary",onClick:r[12]||(r[12]=s=>e(te)(c.value))},i(e(a)("email.release")),1)])]),_:1})]),_:1})])])]),_:1},8,["class"])]),_:1},8,["show"])],64)}}});export{Yt as default};
