import{o,c as n,a as e,u as se,b as oe,x as ne,r as y,f as N,e as ae,g as le,l as _,m,h as t,t as i,k as v,s as F,F as b,q as $,y as re,n as B,j as I,p as g,z as C,N as ie,A as D,_ as de,U as ce,v as S,B as ue,C as me}from"./index.d297ea8f.js";import{r as pe,a as he}from"./TrashIcon.c45359e2.js";function ve(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function xe(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function _e(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function fe(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function we(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function A(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])}function ke(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})])}function ye(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})])}function ge(x,s){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})])}const be={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},Ce={class:"flex justify-between py-3 lg:mx-auto lg:max-w-6xl"},Me={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},He=["onClick"],je={class:"hidden md:inline"},$e={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Le={class:"inline-flex sm:shadow-sm"},Be=["onClick"],Se={class:"hidden md:inline"},Ae=["onClick"],Te={class:"hidden md:inline"},Re={class:"hidden md:inline"},ze={class:"px-4 sm:px-6 lg:px-8"},Ee={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6 lg:mx-auto lg:max-w-6xl"},Ue={class:"px-4 py-5 sm:px-6"},Ve={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},Oe={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},qe={class:"border-t border-context-200 px-4 py-5 sm:p-0"},Ne={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},Fe={class:"text-sm font-medium text-context-500 dark:text-context-400"},Ie={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},De={key:0},Je={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},Ke={class:"sm:hidden"},We=["value","selected"],Ge={class:"hidden sm:block lg:mx-auto lg:max-w-6xl"},Pe={class:"border-b border-context-200 dark:border-context-400"},Qe={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Xe=["aria-current","onClick"],Ye={key:0,class:"lg:mx-auto lg:max-w-6xl"},Ze={key:0,class:"py-6"},et=["height","srcdoc"],tt={key:1,class:"flex justify-center items-center"},st={class:"ml-4 text-context-900 dark:text-context-100"},ot={key:1,class:"py-6"},nt={key:0,class:"text-context-900 dark:text-context-100"},at={class:"overflow-auto"},lt={key:1,class:"flex justify-center items-center"},rt={class:"ml-4 text-context-900 dark:text-context-100"},it={key:2,class:"py-6"},dt={class:"text-context-900 dark:text-context-100"},ct={class:"overflow-auto"},ut={key:3,class:"py-6"},mt={key:0},pt={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},ht={class:"flex w-0 flex-1 items-center"},vt={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},xt={key:0,class:"ml-2"},_t={class:"ml-4 flex-shrink-0"},ft=["onClick"],wt={class:"hidden md:inline"},kt={key:1,class:"flex justify-center items-center"},yt={class:"ml-4 text-context-900 dark:text-context-100"},gt=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),bt={class:"fixed inset-0 z-10 overflow-y-auto"},Ct={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Mt={class:"text-center sm:mt-5"},Ht={class:"mt-6 text-left text-context-900 dark:text-context-100"},jt={class:"space-y-6"},$t={for:"host",class:"form-label"},Lt={class:"mt-1 flex"},Bt={for:"smtp-username",class:"form-label"},St={class:"mt-1"},At=["placeholder"],Tt=["placeholder"],Rt={class:"mt-6 sm:mt-8 flex items-center justify-between"},zt={class:"flex space-x-2 mx-2"},Et=["onClick"],Ut=["onClick"],Nt={__name:"Email",setup(x){const{t:s}=se(),T=oe(),J=ne(),f=y(!1),c=y(null),K=a=>{f.value=!0,window.MailHedgehog.request().get(`emails/${a}`).then(r=>{var u,p;(u=r.data)!=null&&u.data?c.value=(p=r.data)==null?void 0:p.data:c.value=null}).catch(()=>{T.push({path:"/404"})}).finally(()=>{f.value=!1})};N(()=>{K(J.params.id)});const R=()=>{T.push({name:"emails",params:{}})},W=()=>{console.warn("TODO: add confirmation"),f.value=!0,window.MailHedgehog.request().delete(`emails/${c.value.id}`).then(()=>{window.MailHedgehog.success(s("email.deleted")),me(()=>R())}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{f.value=!1})},z=(a,r,u)=>{const p=new Blob([a],{type:r}),w=document.createElement("a");w.href=URL.createObjectURL(p),w.download=u,w.click(),URL.revokeObjectURL(w.href),w.remove()},G=()=>{z(c.value.source,"text/plain",`${c.value.id}.eml`)},P=a=>{z(a.data,a.contentType,a.filename)},M=y(!1),Q=["Subject","From","To","Cc"],X=ae(()=>{const a={};if(c.value&&c.value.headers)for(let r=0;r<Object.entries(c.value.headers).length;r+=1){const[u,p]=Object.entries(c.value.headers)[r];Array.isArray(p)&&p.length>0&&(M.value||Q.includes(u))&&(a[u]=p)}return a}),h=y("html"),E=[{id:"html"},{id:"plain"},{id:"source"},{id:"attachments"}],U=y("0rem"),Y=a=>{const u=a.currentTarget.contentWindow.document.documentElement.scrollHeight+2;U.value=`${u}px`},d=y({host:"",port:25,username:"",password:""}),V=()=>{let a=localStorage.getItem("smtpReleaseCredentials");if(a)try{a=JSON.parse(atob(a)),typeof a=="object"&&!Array.isArray(a)&&a!==null&&(a.host&&(d.value.host=a.host),a.port&&(d.value.port=a.port),a.username&&(d.value.username=a.username),a.password&&(d.value.password=a.password))}catch(r){console.error(r)}},Z=()=>{localStorage.removeItem("smtpReleaseCredentials"),window.MailHedgehog.success(s("release.deleted"))},ee=()=>{const a={};d.value.host&&(a.host=d.value.host),d.value.port&&(a.port=d.value.port),d.value.username&&(a.username=d.value.username),d.value.password&&(a.password=d.value.password),localStorage.setItem("smtpReleaseCredentials",btoa(JSON.stringify(a))),V(),window.MailHedgehog.success(s("release.saved"))};N(()=>V());const H=y(!1),te=()=>{f.value=!0,window.MailHedgehog.request().post(`emails/${c.value.id}/release`,d.value).then(()=>{H.value=!1,window.MailHedgehog.success(s("email.released"))}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{f.value=!1})};return(a,r)=>{var p,w,O;const u=le("tooltip");return o(),n(b,null,[e("div",{class:B(["flex flex-col justify-center",{"pointer-events-none opacity-75":f.value}])},[e("div",be,[e("div",Ce,[e("div",null,[e("div",Me,[e("button",{type:"button",class:"btn btn--default",onClick:_(R,["prevent"])},[m(t(fe),{class:"md:mr-2 h-5 w-5"}),e("span",je,i(t(s)("email.back")),1)],8,He)])]),e("div",null,[e("div",$e,[e("span",Le,[v((o(),n("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:_(W,["prevent"])},[m(t(pe),{class:"md:mr-2 h-5 w-5"}),e("span",Se,i(t(s)("email.delete")),1)],8,Be)),[[u,t(s)("email.deleteHint")]]),v((o(),n("button",{type:"button",class:"btn btn--default rounded-none",onClick:_(G,["prevent"])},[m(t(we),{class:"md:mr-2 h-5 w-5"}),e("span",Te,i(t(s)("email.download")),1)],8,Ae)),[[u,t(s)("email.downloadHint")]]),v((o(),n("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:r[0]||(r[0]=_(l=>H.value=!0,["prevent"]))},[m(t(ye),{class:"md:mr-2 h-5 w-5"}),e("span",Re,i(t(s)("email.release")),1)])),[[u,t(s)("email.releaseHint")]])])])])])]),e("div",ze,[e("div",Ee,[e("div",Ue,[e("h3",Ve,[e("div",null,i(t(s)("email.headersTitle")),1),e("div",null,[v((o(),n("a",{class:"cursor-pointer",onClick:r[1]||(r[1]=_(l=>M.value=!M.value,["prevent"]))},[M.value?(o(),F(t(ke),{key:0,class:"text-primary-400 h-5 w-5"})):(o(),F(t(he),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[u,M.value?t(s)("email.hintHideHeaders"):t(s)("email.hintShowHeaders")]])])]),e("p",Oe,i(t(s)("email.headersSubtitle")),1)]),e("div",qe,[e("dl",Ne,[(o(!0),n(b,null,$(t(X),(l,k)=>(o(),n("div",{key:k,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[e("dt",Fe,i(k),1),e("dd",Ie,[l.length===1?(o(),n("div",De,i(l[0]),1)):(o(),n("ul",Je,[(o(!0),n(b,null,$(l,(j,L)=>(o(),n("li",{key:L,class:"py-3 pl-3 pr-4 text-sm"},i(j),1))),128))]))])]))),128))])])]),e("div",null,[e("div",Ke,[v(e("select",{id:"tabs","onUpdate:modelValue":r[2]||(r[2]=l=>h.value=l),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(o(),n(b,null,$(E,l=>e("option",{key:l.id,value:l.id,selected:h.value},i(t(s)(`email.tab.${l.id}`)),9,We)),64))],512),[[re,h.value]])]),e("div",Ge,[e("div",Pe,[e("nav",Qe,[(o(),n(b,null,$(E,l=>{var k,j,L,q;return e("a",{key:l.id,href:"#",class:B(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[h.value===l.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":h.value===l.id?"page":void 0,onClick:_(Vt=>h.value=l.id,["prevent"])},[I(i(t(s)(`email.tab.${l.id}`))+" ",1),l.id==="attachments"&&((j=(k=c.value)==null?void 0:k.attachments)==null?void 0:j.length)!==void 0?(o(),n("span",{key:0,class:B(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[h.value===l.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},i((q=(L=c.value)==null?void 0:L.attachments)==null?void 0:q.length),3)):g("",!0)],10,Xe)}),64))])])])]),c.value?(o(),n("div",Ye,[h.value==="html"?(o(),n("div",Ze,[c.value.html?(o(),n("iframe",{key:0,id:"preview-html",height:U.value,srcdoc:c.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:Y},null,40,et)):(o(),n("div",tt,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",st,i(t(s)("email.htmlEmpty")),1)]))])):g("",!0),h.value==="plain"?(o(),n("div",ot,[c.value.plain?(o(),n("div",nt,[e("pre",at,i(c.value.plain),1)])):(o(),n("div",lt,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",rt,i(t(s)("email.plainEmpty")),1)]))])):g("",!0),h.value==="source"?(o(),n("div",it,[e("div",dt,[e("pre",ct,i(c.value.source),1)])])):g("",!0),h.value==="attachments"?(o(),n("div",ut,[((w=(p=c.value)==null?void 0:p.attachments)==null?void 0:w.length)>0?(o(),n("div",mt,[e("ul",pt,[(o(!0),n(b,null,$((O=c.value)==null?void 0:O.attachments,(l,k)=>(o(),n("li",{key:k,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[e("div",ht,[m(t(ge),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),e("span",vt,[e("span",null,i(l.filename),1),l.contentType?(o(),n("span",xt," ("+i(l.contentType)+") ",1)):g("",!0)])]),e("div",_t,[e("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:_(j=>P(l),["prevent"])},[m(t(_e),{class:"md:hidden flex-shrink-0 h-5 w-5"}),e("span",wt,i(t(s)("email.download")),1)],8,ft)])]))),128))])])):(o(),n("div",kt,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",yt,i(t(s)("email.noAttachments")),1)]))])):g("",!0)])):g("",!0)])],2),m(t(ue),{as:"template",show:H.value},{default:C(()=>[m(t(ie),{as:"div",class:B(["relative z-10",{"pointer-events-none":f.value}]),onClose:r[8]||(r[8]=l=>H.value=!1)},{default:C(()=>[m(t(D),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:C(()=>[gt]),_:1}),e("div",bt,[e("div",Ct,[m(t(D),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:C(()=>[m(t(de),{class:"bg-context-50 dark:bg-context-900 relative transform overflow-hidden rounded-lg px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:C(()=>[e("div",null,[e("div",Mt,[m(t(ce),{as:"h3",class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100"},{default:C(()=>[I(i(t(s)("email.releaseHint")),1)]),_:1}),e("div",Ht,[e("div",jt,[e("div",null,[e("label",$t,i(t(s)("release.host")),1),e("div",Lt,[v(e("input",{id:"host","onUpdate:modelValue":r[3]||(r[3]=l=>d.value.host=l),name:"host",type:"text",autocomplete:"host",required:"",class:"form-input rounded-r-none",placeholder:"smtp.provider.com"},null,512),[[S,d.value.host]]),v(e("input",{id:"port","onUpdate:modelValue":r[4]||(r[4]=l=>d.value.port=l),name:"port",type:"number",min:"1",max:"9999",step:"1",autocomplete:"port",required:"",class:"form-input rounded-l-none w-20",placeholder:"25"},null,512),[[S,d.value.port],[u,t(s)("release.port")]])])]),e("div",null,[e("label",Bt,i(t(s)("release.auth")),1),e("div",St,[v(e("input",{id:"smtp-username","onUpdate:modelValue":r[5]||(r[5]=l=>d.value.username=l),name:"smtp-username",type:"text",autocomplete:"smtp-username",class:"form-input rounded-b-none",placeholder:t(s)("release.username")},null,8,At),[[S,d.value.username]]),v(e("input",{id:"smtp-password","onUpdate:modelValue":r[6]||(r[6]=l=>d.value.password=l),name:"smtp-password",type:"password",autocomplete:"smtp-password",class:"form-input rounded-t-none",placeholder:t(s)("release.password")},null,8,Tt),[[S,d.value.password]])])])])])])]),e("div",Rt,[e("button",{type:"button",class:"btn btn--default",onClick:r[7]||(r[7]=l=>H.value=!1)},i(t(s)("email.cancel")),1),e("div",zt,[v((o(),n("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:_(ee,["prevent"])},[m(t(ve),{class:"h-6 w-6"})],8,Et)),[[u,t(s)("release.saveToStorage")]]),v((o(),n("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:_(Z,["prevent"])},[m(t(xe),{class:"h-6 w-6"})],8,Ut)),[[u,t(s)("release.deleteSavedToStorage")]])]),e("button",{type:"button",class:"btn btn--primary",onClick:te},i(t(s)("email.release")),1)])]),_:1})]),_:1})])])]),_:1},8,["class"])]),_:1},8,["show"])],64)}}};export{Nt as default};
