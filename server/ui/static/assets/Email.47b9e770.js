import{o as n,c as a,a as e,b as ae,i as le,J as re,L as ie,u as de,l as b,m as I,e as ce,p as ue,s as _,v,k as t,t as d,q as h,g as D,F as C,f as R,M as me,n as B,j as J,y as g,w as j,K as E,B as pe}from"./index.8076f20d.js";import{r as ve}from"./TrashIcon.c77d56cf.js";import{r as xe}from"./EyeIcon.2d4c05d4.js";import{r as A}from"./ExclamationTriangleIcon.9985ec79.js";import{N as he,o as K,_ as fe,U as _e,f as we}from"./transition.978ecb3e.js";import"./use-outside-click.022748ca.js";function ye(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function ke(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function be(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function ge(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function Ce(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function je(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})])}function $e(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})])}function Me(w,o){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})])}const Le={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},Re={class:"flex justify-between py-3 lg:mx-auto lg:max-w-6xl"},Se={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Be=["onClick"],Ee={class:"hidden md:inline"},Ae={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Te={class:"inline-flex sm:shadow-sm"},Ue=["onClick"],Ve={class:"hidden md:inline"},qe=["onClick"],ze={class:"hidden md:inline"},Ne={class:"hidden md:inline"},Oe={class:"px-4 sm:px-6 lg:px-8"},Fe={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6 lg:mx-auto lg:max-w-6xl"},Ie={class:"px-4 py-5 sm:px-6"},De={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},Je={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},Ke={class:"border-t border-context-200 px-4 py-5 sm:p-0"},We={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},Ge={class:"text-sm font-medium text-context-500 dark:text-context-400"},Pe={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},Qe={key:0},Xe={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},Ye={class:"sm:hidden"},Ze=["value","selected"],He={class:"hidden sm:block lg:mx-auto lg:max-w-6xl"},et={class:"border-b border-context-200 dark:border-context-400"},tt={class:"-mb-px flex space-x-8","aria-label":"Tabs"},st=["aria-current","onClick"],ot={key:0,class:"lg:mx-auto lg:max-w-6xl"},nt={key:0,class:"py-6"},at=["height","srcdoc"],lt={key:1,class:"flex justify-center items-center"},rt={class:"ml-4 text-context-900 dark:text-context-100"},it={key:1,class:"py-6"},dt={key:0,class:"text-context-900 dark:text-context-100"},ct={class:"overflow-auto"},ut={key:1,class:"flex justify-center items-center"},mt={class:"ml-4 text-context-900 dark:text-context-100"},pt={key:2,class:"py-6"},vt={class:"text-context-900 dark:text-context-100"},xt={class:"overflow-auto"},ht={key:3,class:"py-6"},ft={key:0},_t={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},wt={class:"flex w-0 flex-1 items-center"},yt={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},kt={key:0,class:"ml-2"},bt={class:"ml-4 flex-shrink-0"},gt=["onClick"],Ct={class:"hidden md:inline"},jt={key:1,class:"flex justify-center items-center"},$t={class:"ml-4 text-context-900 dark:text-context-100"},Mt=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Lt={class:"fixed inset-0 z-10 overflow-y-auto"},Rt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},St={class:"text-center sm:mt-5"},Bt={class:"mt-6 text-left text-context-900 dark:text-context-100"},Et={class:"space-y-6"},At={for:"host",class:"form-label"},Tt={class:"mt-1 flex"},Ut={for:"smtp-username",class:"form-label"},Vt={class:"mt-1"},qt=["placeholder"],zt=["placeholder"],Nt={class:"mt-6 sm:mt-8 flex items-center justify-between"},Ot={class:"flex space-x-2 mx-2"},Ft=["onClick"],It=["onClick"],Xt={__name:"Email",setup(w){const{t:o}=ae(),l=le("MailHedgehog"),T=re(),W=ie(),G=de(),f=b(!1),c=b(null),P=s=>{f.value=!0,l==null||l.request().get(`emails/${s}`).then(i=>{var m,p;(m=i.data)!=null&&m.data?c.value=(p=i.data)==null?void 0:p.data:c.value=null}).catch(()=>{T.push({path:"/404"})}).finally(()=>{f.value=!1})};I(()=>{P(W.params.id)});const U=()=>{T.push({name:"emails",params:{}})},Q=()=>{G.dispatch("confirmDialog/confirm").then(()=>{f.value=!0,l==null||l.request().delete(`emails/${c.value.id}`).then(()=>{l==null||l.success(o("email.deleted")),pe(()=>U())}).catch(s=>{l.onResponseError(s,"Response Error")}).finally(()=>{f.value=!1})})},V=(s,i,m)=>{const p=new Blob([s],{type:i}),y=document.createElement("a");y.href=URL.createObjectURL(p),y.download=m,y.click(),URL.revokeObjectURL(y.href),y.remove()};function X(s,i){const m=`emails/${c.value.id}/attachment/${s}`;l==null||l.request().get(m).then(()=>{const p=document.createElement("a");p.download=i,p.href=`${l==null?void 0:l.request().defaults.baseURL}/${m}`,document.body.appendChild(p),p.click(),document.body.removeChild(p)}).catch(p=>{l.onResponseError(p,"Response Error")}).finally(()=>{f.value=!1})}const Y=()=>{V(c.value.source,"text/plain",`${c.value.id}.eml`)},Z=s=>{s.data&&s.data.length>0?V(s.data,s.contentType,s.filename):X(s.index,s.filename)},$=b(!1),H=["Subject","From","To","Cc"],ee=ce(()=>{const s={};if(c.value&&c.value.headers)for(let i=0;i<Object.entries(c.value.headers).length;i+=1){const[m,p]=Object.entries(c.value.headers)[i];Array.isArray(p)&&p.length>0&&($.value||H.includes(m))&&(s[m]=p)}return s}),x=b("html"),q=[{id:"html"},{id:"plain"},{id:"source"},{id:"attachments"}],z=b("0rem"),te=s=>{const m=s.currentTarget.contentWindow.document.documentElement.scrollHeight+2;z.value=`${m}px`},u=b({host:"",port:25,username:"",password:""}),N=()=>{let s=localStorage.getItem("smtpReleaseCredentials");if(s)try{s=JSON.parse(atob(s)),typeof s=="object"&&!Array.isArray(s)&&s!==null&&(s.host&&(u.value.host=s.host),s.port&&(u.value.port=s.port),s.username&&(u.value.username=s.username),s.password&&(u.value.password=s.password))}catch(i){l==null||l.error(i.message)}},se=()=>{localStorage.removeItem("smtpReleaseCredentials"),l==null||l.success(o("release.deleted"))},oe=()=>{const s={};u.value.host&&(s.host=u.value.host),u.value.port&&(s.port=u.value.port),u.value.username&&(s.username=u.value.username),u.value.password&&(s.password=u.value.password),localStorage.setItem("smtpReleaseCredentials",btoa(JSON.stringify(s))),N(),l==null||l.success(o("release.saved"))};I(()=>N());const M=b(!1),ne=()=>{f.value=!0,l==null||l.request().post(`emails/${c.value.id}/release`,u.value).then(()=>{M.value=!1,l==null||l.success(o("email.released"))}).catch(()=>{l==null||l.error(o("response.error"))}).finally(()=>{f.value=!1})};return(s,i)=>{var p,y,O;const m=ue("tooltip");return n(),a(C,null,[e("div",{class:B(["flex flex-col justify-center",{"pointer-events-none opacity-75":f.value}])},[e("div",Le,[e("div",Re,[e("div",null,[e("div",Se,[e("button",{type:"button",class:"btn btn--default",onClick:_(U,["prevent"])},[v(t(ge),{class:"md:mr-2 h-5 w-5"}),e("span",Ee,d(t(o)("email.back")),1)],8,Be)])]),e("div",null,[e("div",Ae,[e("span",Te,[h((n(),a("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:_(Q,["prevent"])},[v(t(ve),{class:"md:mr-2 h-5 w-5"}),e("span",Ve,d(t(o)("email.delete")),1)],8,Ue)),[[m,t(o)("email.deleteHint")]]),h((n(),a("button",{type:"button",class:"btn btn--default rounded-none",onClick:_(Y,["prevent"])},[v(t(Ce),{class:"md:mr-2 h-5 w-5"}),e("span",ze,d(t(o)("email.download")),1)],8,qe)),[[m,t(o)("email.downloadHint")]]),h((n(),a("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:i[0]||(i[0]=_(r=>M.value=!0,["prevent"]))},[v(t($e),{class:"md:mr-2 h-5 w-5"}),e("span",Ne,d(t(o)("email.release")),1)])),[[m,t(o)("email.releaseHint")]])])])])])]),e("div",Oe,[e("div",Fe,[e("div",Ie,[e("h3",De,[e("div",null,d(t(o)("email.headersTitle")),1),e("div",null,[h((n(),a("a",{class:"cursor-pointer",onClick:i[1]||(i[1]=_(r=>$.value=!$.value,["prevent"]))},[$.value?(n(),D(t(je),{key:0,class:"text-primary-400 h-5 w-5"})):(n(),D(t(xe),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[m,$.value?t(o)("email.hintHideHeaders"):t(o)("email.hintShowHeaders")]])])]),e("p",Je,d(t(o)("email.headersSubtitle")),1)]),e("div",Ke,[e("dl",We,[(n(!0),a(C,null,R(t(ee),(r,k)=>(n(),a("div",{key:k,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[e("dt",Ge,d(k),1),e("dd",Pe,[r.length===1?(n(),a("div",Qe,d(r[0]),1)):(n(),a("ul",Xe,[(n(!0),a(C,null,R(r,(L,S)=>(n(),a("li",{key:S,class:"py-3 pl-3 pr-4 text-sm"},d(L),1))),128))]))])]))),128))])])]),e("div",null,[e("div",Ye,[h(e("select",{id:"tabs","onUpdate:modelValue":i[2]||(i[2]=r=>x.value=r),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(n(),a(C,null,R(q,r=>e("option",{key:r.id,value:r.id,selected:x.value},d(t(o)(`email.tab.${r.id}`)),9,Ze)),64))],512),[[me,x.value]])]),e("div",He,[e("div",et,[e("nav",tt,[(n(),a(C,null,R(q,r=>{var k,L,S,F;return e("a",{key:r.id,href:"#",class:B(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[x.value===r.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":x.value===r.id?"page":void 0,onClick:_(Dt=>x.value=r.id,["prevent"])},[J(d(t(o)(`email.tab.${r.id}`))+" ",1),r.id==="attachments"&&((L=(k=c.value)==null?void 0:k.attachments)==null?void 0:L.length)!==void 0?(n(),a("span",{key:0,class:B(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[x.value===r.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},d((F=(S=c.value)==null?void 0:S.attachments)==null?void 0:F.length),3)):g("",!0)],10,st)}),64))])])])]),c.value?(n(),a("div",ot,[x.value==="html"?(n(),a("div",nt,[c.value.html?(n(),a("iframe",{key:0,id:"preview-html",height:z.value,srcdoc:c.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:te},null,40,at)):(n(),a("div",lt,[v(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",rt,d(t(o)("email.htmlEmpty")),1)]))])):g("",!0),x.value==="plain"?(n(),a("div",it,[c.value.plain?(n(),a("div",dt,[e("pre",ct,d(c.value.plain),1)])):(n(),a("div",ut,[v(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",mt,d(t(o)("email.plainEmpty")),1)]))])):g("",!0),x.value==="source"?(n(),a("div",pt,[e("div",vt,[e("pre",xt,d(c.value.source),1)])])):g("",!0),x.value==="attachments"?(n(),a("div",ht,[((y=(p=c.value)==null?void 0:p.attachments)==null?void 0:y.length)>0?(n(),a("div",ft,[e("ul",_t,[(n(!0),a(C,null,R((O=c.value)==null?void 0:O.attachments,(r,k)=>(n(),a("li",{key:k,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[e("div",wt,[v(t(Me),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),e("span",yt,[e("span",null,d(r.filename),1),r.contentType?(n(),a("span",kt," ("+d(r.contentType)+") ",1)):g("",!0)])]),e("div",bt,[e("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:_(L=>Z(r),["prevent"])},[v(t(be),{class:"md:hidden flex-shrink-0 h-5 w-5"}),e("span",Ct,d(t(o)("email.download")),1)],8,gt)])]))),128))])])):(n(),a("div",jt,[v(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",$t,d(t(o)("email.noAttachments")),1)]))])):g("",!0)])):g("",!0)])],2),v(t(we),{as:"template",show:M.value},{default:j(()=>[v(t(he),{as:"div",class:B(["relative z-10",{"pointer-events-none":f.value}]),onClose:i[8]||(i[8]=r=>M.value=!1)},{default:j(()=>[v(t(K),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:j(()=>[Mt]),_:1}),e("div",Lt,[e("div",Rt,[v(t(K),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:j(()=>[v(t(fe),{class:"bg-context-50 dark:bg-context-900 relative transform overflow-hidden rounded-lg px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:j(()=>[e("div",null,[e("div",St,[v(t(_e),{as:"h3",class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100"},{default:j(()=>[J(d(t(o)("email.releaseHint")),1)]),_:1}),e("div",Bt,[e("div",Et,[e("div",null,[e("label",At,d(t(o)("release.host")),1),e("div",Tt,[h(e("input",{id:"host","onUpdate:modelValue":i[3]||(i[3]=r=>u.value.host=r),name:"host",type:"text",autocomplete:"host",required:"",class:"form-input rounded-r-none",placeholder:"smtp.provider.com"},null,512),[[E,u.value.host]]),h(e("input",{id:"port","onUpdate:modelValue":i[4]||(i[4]=r=>u.value.port=r),name:"port",type:"number",min:"1",max:"9999",step:"1",autocomplete:"port",required:"",class:"form-input rounded-l-none w-20",placeholder:"25"},null,512),[[E,u.value.port],[m,t(o)("release.port")]])])]),e("div",null,[e("label",Ut,d(t(o)("release.auth")),1),e("div",Vt,[h(e("input",{id:"smtp-username","onUpdate:modelValue":i[5]||(i[5]=r=>u.value.username=r),name:"smtp-username",type:"text",autocomplete:"smtp-username",class:"form-input rounded-b-none",placeholder:t(o)("release.username")},null,8,qt),[[E,u.value.username]]),h(e("input",{id:"smtp-password","onUpdate:modelValue":i[6]||(i[6]=r=>u.value.password=r),name:"smtp-password",type:"password",autocomplete:"smtp-password",class:"form-input rounded-t-none",placeholder:t(o)("release.password")},null,8,zt),[[E,u.value.password]])])])])])])]),e("div",Nt,[e("button",{type:"button",class:"btn btn--default",onClick:i[7]||(i[7]=r=>M.value=!1)},d(t(o)("email.cancel")),1),e("div",Ot,[h((n(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:_(oe,["prevent"])},[v(t(ye),{class:"h-6 w-6"})],8,Ft)),[[m,t(o)("release.saveToStorage")]]),h((n(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:_(se,["prevent"])},[v(t(ke),{class:"h-6 w-6"})],8,It)),[[m,t(o)("release.deleteSavedToStorage")]])]),e("button",{type:"button",class:"btn btn--primary",onClick:ne},d(t(o)("email.release")),1)])]),_:1})]),_:1})])])]),_:1},8,["class"])]),_:1},8,["show"])],64)}}};export{Xt as default};
