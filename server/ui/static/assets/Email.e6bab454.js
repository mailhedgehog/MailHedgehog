import{o,c as a,a as e,u as oe,b as ae,x as ne,d as le,r as y,f as O,e as re,g as ie,l as x,m,h as t,t as i,k as v,s as F,F as b,q as $,y as de,n as S,j as D,p as g,z as A,A as C,N as ce,B as I,_ as ue,U as me,v as B,C as pe,D as he}from"./index.67e2181d.js";import{r as ve,a as xe}from"./TrashIcon.7add3bee.js";function _e(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function fe(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})])}function we(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function ke(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})])}function ye(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function ge(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})])}function be(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})])}function Ce(_,s){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})])}const Me={class:"bg-context-50 dark:bg-context-900 px-4 sm:px-6 lg:px-8 shadow dark:shadow-context-500 mb-6 md:mb-8"},He={class:"flex justify-between py-3 lg:mx-auto lg:max-w-6xl"},je={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},$e=["onClick"],Le={class:"hidden md:inline"},Se={class:"isolate inline-flex rounded-md shadow-sm sm:space-x-3 sm:shadow-none"},Be={class:"inline-flex sm:shadow-sm"},Ae=["onClick"],Te={class:"hidden md:inline"},Re=["onClick"],Ee={class:"hidden md:inline"},Ue={class:"hidden md:inline"},Ve={class:"px-4 sm:px-6 lg:px-8"},ze={class:"overflow-hidden bg-context-50 dark:bg-context-900 border border-context-300 shadow dark:shadow-context-500 sm:rounded-lg mb-6 lg:mx-auto lg:max-w-6xl"},qe={class:"px-4 py-5 sm:px-6"},Ne={class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100 flex justify-between"},Oe={class:"mt-1 max-w-2xl text-sm text-context-500 dark:text-context-400"},Fe={class:"border-t border-context-200 px-4 py-5 sm:p-0"},De={class:"sm:divide-y sm:divide-context-200 sm:dark:divide-context-300"},Ie={class:"text-sm font-medium text-context-500 dark:text-context-400"},Je={class:"mt-1 text-sm text-context-900 dark:text-context-100 sm:col-span-2 sm:mt-0"},Ke={key:0},We={key:1,role:"list",class:"divide-y divide-context-200 dark:divide-context-200 rounded-md border border-context-200 dark:border-context-200"},Ge={class:"sm:hidden"},Pe=["value","selected"],Qe={class:"hidden sm:block lg:mx-auto lg:max-w-6xl"},Xe={class:"border-b border-context-200 dark:border-context-400"},Ye={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Ze=["aria-current","onClick"],et={key:0,class:"lg:mx-auto lg:max-w-6xl"},tt={key:0,class:"py-6"},st=["height","srcdoc"],ot={key:1,class:"flex justify-center items-center"},at={class:"ml-4 text-context-900 dark:text-context-100"},nt={key:1,class:"py-6"},lt={key:0,class:"text-context-900 dark:text-context-100"},rt={class:"overflow-auto"},it={key:1,class:"flex justify-center items-center"},dt={class:"ml-4 text-context-900 dark:text-context-100"},ct={key:2,class:"py-6"},ut={class:"text-context-900 dark:text-context-100"},mt={class:"overflow-auto"},pt={key:3,class:"py-6"},ht={key:0},vt={role:"list",class:"divide-y divide-context-200 rounded-md border border-context-200"},xt={class:"flex w-0 flex-1 items-center"},_t={class:"ml-2 w-0 flex-1 text-context-900 dark:text-context-100 truncate"},ft={key:0,class:"ml-2"},wt={class:"ml-4 flex-shrink-0"},kt=["onClick"],yt={class:"hidden md:inline"},gt={key:1,class:"flex justify-center items-center"},bt={class:"ml-4 text-context-900 dark:text-context-100"},Ct=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Mt={class:"fixed inset-0 z-10 overflow-y-auto"},Ht={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},jt={class:"text-center sm:mt-5"},$t={class:"mt-6 text-left text-context-900 dark:text-context-100"},Lt={class:"space-y-6"},St={for:"host",class:"form-label"},Bt={class:"mt-1 flex"},At={for:"smtp-username",class:"form-label"},Tt={class:"mt-1"},Rt=["placeholder"],Et=["placeholder"],Ut={class:"mt-6 sm:mt-8 flex items-center justify-between"},Vt={class:"flex space-x-2 mx-2"},zt=["onClick"],qt=["onClick"],Dt={__name:"Email",setup(_){const{t:s}=oe(),T=ae(),J=ne(),K=le(),f=y(!1),c=y(null),W=n=>{f.value=!0,window.MailHedgehog.request().get(`emails/${n}`).then(r=>{var u,p;(u=r.data)!=null&&u.data?c.value=(p=r.data)==null?void 0:p.data:c.value=null}).catch(()=>{T.push({path:"/404"})}).finally(()=>{f.value=!1})};O(()=>{W(J.params.id)});const R=()=>{T.push({name:"emails",params:{}})},G=()=>{K.dispatch("confirmDialog/confirm").then(()=>{f.value=!0,window.MailHedgehog.request().delete(`emails/${c.value.id}`).then(()=>{window.MailHedgehog.success(s("email.deleted")),he(()=>R())}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{f.value=!1})})},E=(n,r,u)=>{const p=new Blob([n],{type:r}),w=document.createElement("a");w.href=URL.createObjectURL(p),w.download=u,w.click(),URL.revokeObjectURL(w.href),w.remove()},P=()=>{E(c.value.source,"text/plain",`${c.value.id}.eml`)},Q=n=>{E(n.data,n.contentType,n.filename)},M=y(!1),X=["Subject","From","To","Cc"],Y=re(()=>{const n={};if(c.value&&c.value.headers)for(let r=0;r<Object.entries(c.value.headers).length;r+=1){const[u,p]=Object.entries(c.value.headers)[r];Array.isArray(p)&&p.length>0&&(M.value||X.includes(u))&&(n[u]=p)}return n}),h=y("html"),U=[{id:"html"},{id:"plain"},{id:"source"},{id:"attachments"}],V=y("0rem"),Z=n=>{const u=n.currentTarget.contentWindow.document.documentElement.scrollHeight+2;V.value=`${u}px`},d=y({host:"",port:25,username:"",password:""}),z=()=>{let n=localStorage.getItem("smtpReleaseCredentials");if(n)try{n=JSON.parse(atob(n)),typeof n=="object"&&!Array.isArray(n)&&n!==null&&(n.host&&(d.value.host=n.host),n.port&&(d.value.port=n.port),n.username&&(d.value.username=n.username),n.password&&(d.value.password=n.password))}catch(r){window.MailHedgehog.error(r.message)}},ee=()=>{localStorage.removeItem("smtpReleaseCredentials"),window.MailHedgehog.success(s("release.deleted"))},te=()=>{const n={};d.value.host&&(n.host=d.value.host),d.value.port&&(n.port=d.value.port),d.value.username&&(n.username=d.value.username),d.value.password&&(n.password=d.value.password),localStorage.setItem("smtpReleaseCredentials",btoa(JSON.stringify(n))),z(),window.MailHedgehog.success(s("release.saved"))};O(()=>z());const H=y(!1),se=()=>{f.value=!0,window.MailHedgehog.request().post(`emails/${c.value.id}/release`,d.value).then(()=>{H.value=!1,window.MailHedgehog.success(s("email.released"))}).catch(()=>{window.MailHedgehog.error(s("response.error"))}).finally(()=>{f.value=!1})};return(n,r)=>{var p,w,q;const u=ie("tooltip");return o(),a(b,null,[e("div",{class:S(["flex flex-col justify-center",{"pointer-events-none opacity-75":f.value}])},[e("div",Me,[e("div",He,[e("div",null,[e("div",je,[e("button",{type:"button",class:"btn btn--default",onClick:x(R,["prevent"])},[m(t(ke),{class:"md:mr-2 h-5 w-5"}),e("span",Le,i(t(s)("email.back")),1)],8,$e)])]),e("div",null,[e("div",Se,[e("span",Be,[v((o(),a("button",{type:"button",class:"btn btn--default rounded-r-none rounded-l-md",onClick:x(G,["prevent"])},[m(t(ve),{class:"md:mr-2 h-5 w-5"}),e("span",Te,i(t(s)("email.delete")),1)],8,Ae)),[[u,t(s)("email.deleteHint")]]),v((o(),a("button",{type:"button",class:"btn btn--default rounded-none",onClick:x(P,["prevent"])},[m(t(ye),{class:"md:mr-2 h-5 w-5"}),e("span",Ee,i(t(s)("email.download")),1)],8,Re)),[[u,t(s)("email.downloadHint")]]),v((o(),a("button",{type:"button",class:"btn btn--default rounded-r-md rounded-l-none",onClick:r[0]||(r[0]=x(l=>H.value=!0,["prevent"]))},[m(t(be),{class:"md:mr-2 h-5 w-5"}),e("span",Ue,i(t(s)("email.release")),1)])),[[u,t(s)("email.releaseHint")]])])])])])]),e("div",Ve,[e("div",ze,[e("div",qe,[e("h3",Ne,[e("div",null,i(t(s)("email.headersTitle")),1),e("div",null,[v((o(),a("a",{class:"cursor-pointer",onClick:r[1]||(r[1]=x(l=>M.value=!M.value,["prevent"]))},[M.value?(o(),F(t(ge),{key:0,class:"text-primary-400 h-5 w-5"})):(o(),F(t(xe),{key:1,class:"text-primary-700 h-5 w-5"}))])),[[u,M.value?t(s)("email.hintHideHeaders"):t(s)("email.hintShowHeaders")]])])]),e("p",Oe,i(t(s)("email.headersSubtitle")),1)]),e("div",Fe,[e("dl",De,[(o(!0),a(b,null,$(t(Y),(l,k)=>(o(),a("div",{key:k,class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:py-5 sm:px-6"},[e("dt",Ie,i(k),1),e("dd",Je,[l.length===1?(o(),a("div",Ke,i(l[0]),1)):(o(),a("ul",We,[(o(!0),a(b,null,$(l,(j,L)=>(o(),a("li",{key:L,class:"py-3 pl-3 pr-4 text-sm"},i(j),1))),128))]))])]))),128))])])]),e("div",null,[e("div",Ge,[v(e("select",{id:"tabs","onUpdate:modelValue":r[2]||(r[2]=l=>h.value=l),name:"tabs",class:"block w-full rounded border-context-300 dark:border-context-600 py-2 pl-3 pr-10 text-base focus:border-primary-500 focus:primary-none focus:ring-primary-500 sm:text-sm"},[(o(),a(b,null,$(U,l=>e("option",{key:l.id,value:l.id,selected:h.value},i(t(s)(`email.tab.${l.id}`)),9,Pe)),64))],512),[[de,h.value]])]),e("div",Qe,[e("div",Xe,[e("nav",Ye,[(o(),a(b,null,$(U,l=>{var k,j,L,N;return e("a",{key:l.id,href:"#",class:S(["whitespace-nowrap flex py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-500",[h.value===l.id?"border-primary-500 text-primary-600":"cursor-pointer border-transparent text-context-500 dark:text-context-400 hover:text-context-700 hover:dark:text-context-300 hover:border-context-200 hover:dark:border-context-400"]]),"aria-current":h.value===l.id?"page":void 0,onClick:x(Nt=>h.value=l.id,["prevent"])},[D(i(t(s)(`email.tab.${l.id}`))+" ",1),l.id==="attachments"&&((j=(k=c.value)==null?void 0:k.attachments)==null?void 0:j.length)!==void 0?(o(),a("span",{key:0,class:S(["inline-block ml-3 py-0.5 px-2.5 rounded-full text-xs font-medium transition-colors duration-500",[h.value===l.id?"bg-primary-100 text-primary-600":"bg-context-200 dark:bg-context-700 text-context-900 dark:text-context-100"]])},i((N=(L=c.value)==null?void 0:L.attachments)==null?void 0:N.length),3)):g("",!0)],10,Ze)}),64))])])])]),c.value?(o(),a("div",et,[h.value==="html"?(o(),a("div",tt,[c.value.html?(o(),a("iframe",{key:0,id:"preview-html",height:V.value,srcdoc:c.value.html,class:"w-full border border-context-200 dark:border-context-400",onLoad:Z},null,40,st)):(o(),a("div",ot,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",at,i(t(s)("email.htmlEmpty")),1)]))])):g("",!0),h.value==="plain"?(o(),a("div",nt,[c.value.plain?(o(),a("div",lt,[e("pre",rt,i(c.value.plain),1)])):(o(),a("div",it,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",dt,i(t(s)("email.plainEmpty")),1)]))])):g("",!0),h.value==="source"?(o(),a("div",ct,[e("div",ut,[e("pre",mt,i(c.value.source),1)])])):g("",!0),h.value==="attachments"?(o(),a("div",pt,[((w=(p=c.value)==null?void 0:p.attachments)==null?void 0:w.length)>0?(o(),a("div",ht,[e("ul",vt,[(o(!0),a(b,null,$((q=c.value)==null?void 0:q.attachments,(l,k)=>(o(),a("li",{key:k,class:"flex items-center justify-between py-3 pl-3 pr-4 text-sm"},[e("div",xt,[m(t(Ce),{class:"text-context-400 dark:text-context-500 flex-shrink-0 h-5 w-5"}),e("span",_t,[e("span",null,i(l.filename),1),l.contentType?(o(),a("span",ft," ("+i(l.contentType)+") ",1)):g("",!0)])]),e("div",wt,[e("a",{class:"cursor-pointer font-medium text-primary-500 hover:text-primary-600 transition-colors duration-500",onClick:x(j=>Q(l),["prevent"])},[m(t(we),{class:"md:hidden flex-shrink-0 h-5 w-5"}),e("span",yt,i(t(s)("email.download")),1)],8,kt)])]))),128))])])):(o(),a("div",gt,[m(t(A),{class:"text-primary-500 h-8 w-8"}),e("div",bt,i(t(s)("email.noAttachments")),1)]))])):g("",!0)])):g("",!0)])],2),m(t(pe),{as:"template",show:H.value},{default:C(()=>[m(t(ce),{as:"div",class:S(["relative z-10",{"pointer-events-none":f.value}]),onClose:r[8]||(r[8]=l=>H.value=!1)},{default:C(()=>[m(t(I),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:C(()=>[Ct]),_:1}),e("div",Mt,[e("div",Ht,[m(t(I),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:C(()=>[m(t(ue),{class:"bg-context-50 dark:bg-context-900 relative transform overflow-hidden rounded-lg px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:C(()=>[e("div",null,[e("div",jt,[m(t(me),{as:"h3",class:"text-lg font-medium leading-6 text-context-900 dark:text-context-100"},{default:C(()=>[D(i(t(s)("email.releaseHint")),1)]),_:1}),e("div",$t,[e("div",Lt,[e("div",null,[e("label",St,i(t(s)("release.host")),1),e("div",Bt,[v(e("input",{id:"host","onUpdate:modelValue":r[3]||(r[3]=l=>d.value.host=l),name:"host",type:"text",autocomplete:"host",required:"",class:"form-input rounded-r-none",placeholder:"smtp.provider.com"},null,512),[[B,d.value.host]]),v(e("input",{id:"port","onUpdate:modelValue":r[4]||(r[4]=l=>d.value.port=l),name:"port",type:"number",min:"1",max:"9999",step:"1",autocomplete:"port",required:"",class:"form-input rounded-l-none w-20",placeholder:"25"},null,512),[[B,d.value.port],[u,t(s)("release.port")]])])]),e("div",null,[e("label",At,i(t(s)("release.auth")),1),e("div",Tt,[v(e("input",{id:"smtp-username","onUpdate:modelValue":r[5]||(r[5]=l=>d.value.username=l),name:"smtp-username",type:"text",autocomplete:"smtp-username",class:"form-input rounded-b-none",placeholder:t(s)("release.username")},null,8,Rt),[[B,d.value.username]]),v(e("input",{id:"smtp-password","onUpdate:modelValue":r[6]||(r[6]=l=>d.value.password=l),name:"smtp-password",type:"password",autocomplete:"smtp-password",class:"form-input rounded-t-none",placeholder:t(s)("release.password")},null,8,Et),[[B,d.value.password]])])])])])])]),e("div",Ut,[e("button",{type:"button",class:"btn btn--default",onClick:r[7]||(r[7]=l=>H.value=!1)},i(t(s)("email.cancel")),1),e("div",Vt,[v((o(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:x(te,["prevent"])},[m(t(_e),{class:"h-6 w-6"})],8,zt)),[[u,t(s)("release.saveToStorage")]]),v((o(),a("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500",onClick:x(ee,["prevent"])},[m(t(fe),{class:"h-6 w-6"})],8,qt)),[[u,t(s)("release.deleteSavedToStorage")]])]),e("button",{type:"button",class:"btn btn--primary",onClick:se},i(t(s)("email.release")),1)])]),_:1})]),_:1})])])]),_:1},8,["class"])]),_:1},8,["show"])],64)}}};export{Dt as default};
